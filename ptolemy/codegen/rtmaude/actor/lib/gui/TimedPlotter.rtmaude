/***moduleName***/
TIMED-PLOTTER-ACTOR/**/

/***className***/
TimedPlotter/**/

/***sharedBlock***/
(tomod TIMED-PLOTTER-ACTOR is 
  inc ACTOR-WITH-TIMER .

  class TimedPlotter | 
    event-history : EventHistory .
    subclass TimedPlotter < TimeActor .
  eq ^ TimedPlotter = Actor .

  sort EventPair  EventHistory .
  subsort EventPair < EventHistory .
  op source:_time:_value:_ : EPortId Time Value -> EventPair .
  op emptyHistory : -> EventHistory .
  op _++_ : EventHistory EventHistory -> EventHistory [ctor assoc id: emptyHistory] .
  
  vars O : Oid . 
  var EH : EventHistory . var EP : EventPair .
  var NZT : NzTime . var T : Time . var V : Value .
  vars PORTS : Configuration . vars PI : PortId .
  var EPI : EPortId . var CHS : ChannelSet .
  var UPDATED : Bool .

---------------------------------------------------------------------
--- Semantics Steps
---------------------------------------------------------------------

  eq executeStep(TimedPlotter, 
    < O : TimedPlotter | 
      current-time : T,
      event-history : EH,
      ports :
        < PI : MultiInPort | channels : CHS > PORTS 
    >) 
   = executeStep(^ TimedPlotter,
    < O : TimedPlotter | 
      event-history : EH ++ genEventHistory(T, CHS)
    >) .

    op genEventHistory : Time ChannelSet -> EventHistory .
    eq genEventHistory(T, [EPI,present,V] ; CHS)
     = (source: EPI time: T value: V) ++ genEventHistory(T, CHS) .
    eq genEventHistory(T, CHS) = emptyHistory [owise] .
endtom)
/**/