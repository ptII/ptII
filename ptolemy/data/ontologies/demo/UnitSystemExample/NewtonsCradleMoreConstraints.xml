<?xml version="1.0" standalone="no"?>
<!DOCTYPE entity PUBLIC "-//UC Berkeley//DTD MoML 1//EN"
    "http://ptolemy.eecs.berkeley.edu/xml/dtd/MoML_1.dtd">
<entity name="NewtonsCradleMoreConstraints" class="ptolemy.actor.TypedCompositeActor">
    <property name="_createdBy" class="ptolemy.kernel.attributes.VersionAttribute" value="8.1.devel">
    </property>
    <property name="acceleration" class="ptolemy.data.expr.Parameter" value="9.8">
        <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
            <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
            </property>
        </property>
        <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
        </property>
        <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[185.0, 25.0]">
        </property>
        <property name="_hideName" class="ptolemy.data.expr.SingletonParameter" value="true">
        </property>
    </property>
    <property name="initialTheta1" class="ptolemy.data.expr.Parameter" value="-PI/8">
        <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
        </property>
        <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
            <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
            </property>
        </property>
        <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
        </property>
        <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[185.0, 90.0]">
        </property>
    </property>
    <property name="initialTheta_1_dot" class="ptolemy.data.expr.Parameter" value="0.0">
        <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
        </property>
        <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
            <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
            </property>
        </property>
        <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
        </property>
        <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[185.0, 110.0]">
        </property>
    </property>
    <property name="length" class="ptolemy.data.expr.Parameter" value="8.0">
        <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
        </property>
        <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
            <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
            </property>
        </property>
        <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
        </property>
        <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[185.0, 45.0]">
        </property>
    </property>
    <property name="diameter" class="ptolemy.data.expr.Parameter" value="2.0">
        <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
        </property>
        <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
            <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
            </property>
        </property>
        <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
        </property>
        <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[185.0, 65.0]">
        </property>
    </property>
    <property name="initialTheta2" class="ptolemy.data.expr.Parameter" value="0.0">
        <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
        </property>
        <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
            <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
            </property>
        </property>
        <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
        </property>
        <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[365.0, 30.0]">
        </property>
    </property>
    <property name="initialTheta_2_dot" class="ptolemy.data.expr.Parameter" value="0.0">
        <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
        </property>
        <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
            <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
            </property>
        </property>
        <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
        </property>
        <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[365.0, 50.0]">
        </property>
    </property>
    <property name="initialTheta3" class="ptolemy.data.expr.Parameter" value="0.0">
        <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
        </property>
        <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
            <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
            </property>
        </property>
        <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
        </property>
        <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[365.0, 80.0]">
        </property>
    </property>
    <property name="initialTheta_3_dot" class="ptolemy.data.expr.Parameter" value="0.0">
        <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
        </property>
        <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
            <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
            </property>
        </property>
        <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
        </property>
        <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[365.0, 100.0]">
        </property>
    </property>
    <property name="Continuous Director" class="ptolemy.domains.continuous.kernel.ContinuousDirector">
        <property name="stopTime" class="ptolemy.data.expr.Parameter" value="30">
        </property>
        <property name="maxStepSize" class="ptolemy.data.expr.Parameter" value="1">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[45.0, 45.0]">
        </property>
    </property>
    <property name="_windowProperties" class="ptolemy.actor.gui.WindowPropertiesAttribute" value="{bounds={716, 53, 924, 745}, maximized=false}">
    </property>
    <property name="_vergilSize" class="ptolemy.actor.gui.SizeAttribute" value="[709, 628]">
    </property>
    <property name="_vergilZoomFactor" class="ptolemy.data.expr.ExpertParameter" value="1.0">
    </property>
    <property name="_vergilCenter" class="ptolemy.data.expr.ExpertParameter" value="{322.2637246621621, 284.5167863175676}">
    </property>
    <property name="annotation" class="ptolemy.kernel.util.Attribute">
        <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
        </property>
        <property name="_iconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure><svg><text x="20" y="20" style="font-size:14; font-family:SansSerif; fill:darkgray">Author: Haiyang Zheng and Edward A. Lee</text></svg></configure>
        </property>
        <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
            <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-A-</text>
      </svg>
    </configure>
        </property>
        <property name="_controllerFactory" class="ptolemy.vergil.basic.NodeControllerFactory">
        </property>
        <property name="_editorFactory" class="ptolemy.vergil.toolbox.AnnotationEditorFactory">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[-5.0, 520.0]">
        </property>
    </property>
    <property name="Annotation" class="ptolemy.vergil.kernel.attributes.TextAttribute">
        <property name="text" class="ptolemy.kernel.util.StringAttribute" value="This model simulates Newton's cradle with three balls.&#10;Newton's cradle is a toy with steel balls hanging on strings&#10;and colliding with one another.">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[10.0, 470.0]">
        </property>
    </property>
    <property name="MechanicsUnitsOntologySolver" class="ptolemy.data.ontologies.lattice.DeltaConstraintSolver">
        <property name="modelURL" class="ptolemy.data.expr.StringParameter" value="MechanicsUnitsSolverModel.xml">
        </property>
        <property name="solverStrategy" class="ptolemy.data.expr.StringParameter" value="bidirectional">
        </property>
        <property name="DisplayActions" class="ptolemy.data.ontologies.gui.DeltaConstraintSolverDisplayActions">
        </property>
        <property name="_controllerFactory" class="ptolemy.vergil.toolbox.MoMLModelAttributeControllerFactory">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[45.0, 120.0]">
        </property>
    </property>
    <class name="BallClass" extends="ptolemy.actor.TypedCompositeActor">
        <property name="_location" class="ptolemy.kernel.util.Location" value="[90.0, 190.0]">
        </property>
        <property name="acceleration" class="ptolemy.data.expr.Parameter" value="acceleration">
            <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
                <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
                </property>
            </property>
            <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
                <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
            </property>
            <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[35.0, 30.0]">
            </property>
            <property name="_hideName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
        </property>
        <property name="length" class="ptolemy.data.expr.Parameter" value="length">
            <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
            </property>
            <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
                <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
                </property>
            </property>
            <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
                <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
            </property>
            <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[35.0, 55.0]">
            </property>
        </property>
        <property name="_windowProperties" class="ptolemy.actor.gui.WindowPropertiesAttribute" value="{bounds={527, 439, 877, 612}, maximized=false}">
        </property>
        <property name="_vergilSize" class="ptolemy.actor.gui.SizeAttribute" value="[662, 495]">
        </property>
        <property name="_vergilZoomFactor" class="ptolemy.data.expr.ExpertParameter" value="1.0">
        </property>
        <property name="_vergilCenter" class="ptolemy.data.expr.ExpertParameter" value="{379.9729729729729, 458.6756756756756}">
        </property>
        <property name="initialTheta" class="ptolemy.actor.parameters.PortParameter" value="0.0">
            <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
            </property>
            <property name="_iconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
                <configure>
      <svg>	<polyline points="-15,-15, -3,-5, -16,5" style="stroke:black"></polyline>
      </svg>
    </configure>
            </property>
            <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
            </property>
            <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
                <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:black" y="20">-P-</text>
      </svg>
    </configure>
            </property>
            <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[265.0, 40.0]">
            </property>
        </property>
        <property name="initialTheta_dot" class="ptolemy.actor.parameters.PortParameter" value="0.0">
            <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
            </property>
            <property name="_iconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
                <configure>
      <svg>
	<polyline points="-15,-15, -3,-5, -16,5" style="stroke:black"></polyline>
      </svg>
    </configure>
            </property>
            <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
            </property>
            <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
                <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:black" y="20">-P-</text>
      </svg>
    </configure>
            </property>
            <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[265.0, 70.0]">
            </property>
        </property>
        <property name="x_offset" class="ptolemy.data.expr.Parameter" value="0.0">
            <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
                <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
                </property>
            </property>
            <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
                <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
            </property>
            <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[35.0, 80.0]">
            </property>
            <property name="_hideName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
        </property>
        <property name="y_offset" class="ptolemy.data.expr.Parameter" value="0.0">
            <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
            </property>
            <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
                <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
                </property>
            </property>
            <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
                <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
            </property>
            <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[35.0, 105.0]">
            </property>
        </property>
        <property name="annotation" class="ptolemy.kernel.util.Attribute">
            <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
            </property>
            <property name="_iconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
                <configure><svg><text x="20" y="20" style="font-size:14; font-family:SansSerif; fill:blue">This class defines the dynamics of a pendulum. </text></svg></configure>
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[50.0, 370.0]">
            </property>
            <property name="_controllerFactory" class="ptolemy.vergil.basic.NodeControllerFactory">
            </property>
            <property name="_editorFactory" class="ptolemy.vergil.toolbox.AnnotationEditorFactory">
            </property>
        </property>
        <property name="Image" class="ptolemy.vergil.kernel.attributes.ImageAttribute">
            <property name="source" class="ptolemy.data.expr.FileParameter" value="$CLASSPATH/ptolemy/domains/continuous/demo/NewtonsCradle/pendulum.gif">
            </property>
            <property name="scale" class="ptolemy.data.expr.Parameter" value="100">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[525.0, 295.0]">
            </property>
        </property>
        <property name="MechanicsUnitsOntologySolver::constraint" class="ptolemy.data.ontologies.OntologyAnnotationAttribute" value="acceleration &gt;= Acceleration_m_per_sec2">
            <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
            </property>
            <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
                <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{1.0, 0.0, 0.0, 1.0}">
                </property>
            </property>
            <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
                <configure><svg><text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-A-</text></svg></configure>
            </property>
            <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[30.0, 440.0]">
            </property>
        </property>
        <property name="MechanicsUnitsOntologySolver::constraint2" class="ptolemy.data.ontologies.OntologyAnnotationAttribute" value="length &gt;= PendulumLength_m">
            <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
            </property>
            <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
                <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{1.0, 0.0, 0.0, 1.0}">
                </property>
            </property>
            <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
                <configure><svg><text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-A-</text></svg></configure>
            </property>
            <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[30.0, 460.0]">
            </property>
        </property>
        <property name="MechanicsUnitsOntologySolver::constraint3" class="ptolemy.data.ontologies.OntologyAnnotationAttribute" value="Expression.output &gt;= Dimensionless">
            <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
            </property>
            <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
                <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{1.0, 0.0, 0.0, 1.0}">
                </property>
            </property>
            <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
                <configure><svg><text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-A-</text></svg></configure>
            </property>
            <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[30.0, 480.0]">
            </property>
        </property>
        <port name="initialTheta" class="ptolemy.actor.parameters.ParameterPort">
            <property name="input"/>
            <property name="_location" class="ptolemy.kernel.util.Location" value="{245.0, 35.0}">
            </property>
            <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
        </port>
        <port name="initialTheta_dot" class="ptolemy.actor.parameters.ParameterPort">
            <property name="input"/>
            <property name="_location" class="ptolemy.kernel.util.Location" value="{245.0, 65.0}">
            </property>
            <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
        </port>
        <port name="x" class="ptolemy.actor.TypedIOPort">
            <property name="output"/>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[590.0, 165.0]">
            </property>
            <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
        </port>
        <port name="y" class="ptolemy.actor.TypedIOPort">
            <property name="output"/>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[590.0, 120.0]">
            </property>
        </port>
        <port name="theta" class="ptolemy.actor.TypedIOPort">
            <property name="output"/>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[320.0, 305.0]">
            </property>
        </port>
        <port name="theta_dot" class="ptolemy.actor.TypedIOPort">
            <property name="output"/>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[210.0, 305.0]">
            </property>
            <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
        </port>
        <entity name="theta_dot" class="ptolemy.domains.continuous.lib.Integrator">
            <property name="initialState" class="ptolemy.actor.parameters.PortParameter" value="initialTheta_dot">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[120.486328125, 249.501953125]">
            </property>
        </entity>
        <entity name="theta" class="ptolemy.domains.continuous.lib.Integrator">
            <property name="initialState" class="ptolemy.actor.parameters.PortParameter" value="initialTheta">
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[225.486328125, 249.501953125]">
            </property>
        </entity>
        <entity name="Expression" class="ptolemy.actor.lib.Expression">
            <property name="expression" class="ptolemy.kernel.util.StringAttribute" value="-1*sin(theta)">
            </property>
            <property name="_icon" class="ptolemy.vergil.icon.BoxedValueIcon">
                <property name="attributeName" class="ptolemy.kernel.util.StringAttribute" value="expression">
                </property>
                <property name="displayWidth" class="ptolemy.data.expr.Parameter" value="60">
                </property>
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[385.0, 250.0]">
            </property>
            <port name="theta" class="ptolemy.actor.TypedIOPort">
                <property name="input"/>
            </port>
        </entity>
        <entity name="PolarToCartesian" class="ptolemy.actor.lib.conversions.PolarToCartesian">
            <property name="_location" class="ptolemy.kernel.util.Location" value="[345.0, 130.0]">
            </property>
            <port name="angle" class="ptolemy.actor.TypedIOPort">
                <property name="input"/>
                <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
                </property>
            </port>
        </entity>
        <entity name="Const" class="ptolemy.actor.lib.Const">
            <property name="value" class="ptolemy.data.expr.Parameter" value="length">
            </property>
            <doc>Create a constant sequence</doc>
            <property name="_icon" class="ptolemy.vergil.icon.BoxedValueIcon">
                <property name="attributeName" class="ptolemy.kernel.util.StringAttribute" value="value">
                </property>
                <property name="displayWidth" class="ptolemy.data.expr.Parameter" value="60">
                </property>
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[215.0, 120.0]">
            </property>
        </entity>
        <entity name="x position" class="ptolemy.actor.lib.Expression">
            <property name="expression" class="ptolemy.kernel.util.StringAttribute" value="in + x_offset">
            </property>
            <property name="_icon" class="ptolemy.vergil.icon.BoxedValueIcon">
                <property name="attributeName" class="ptolemy.kernel.util.StringAttribute" value="expression">
                </property>
                <property name="displayWidth" class="ptolemy.data.expr.Parameter" value="60">
                </property>
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[480.0, 165.0]">
            </property>
            <port name="in" class="ptolemy.actor.TypedIOPort">
                <property name="input"/>
            </port>
        </entity>
        <entity name="y position" class="ptolemy.actor.lib.Expression">
            <property name="expression" class="ptolemy.kernel.util.StringAttribute" value="in + y_offset">
            </property>
            <property name="_icon" class="ptolemy.vergil.icon.BoxedValueIcon">
                <property name="attributeName" class="ptolemy.kernel.util.StringAttribute" value="expression">
                </property>
                <property name="displayWidth" class="ptolemy.data.expr.Parameter" value="60">
                </property>
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[480.0, 120.0]">
            </property>
            <port name="in" class="ptolemy.actor.TypedIOPort">
                <property name="input"/>
            </port>
        </entity>
        <entity name="Scale" class="ptolemy.actor.lib.Scale">
            <property name="factor" class="ptolemy.data.expr.Parameter" value="acceleration/length">
            </property>
            <property name="_icon" class="ptolemy.vergil.icon.AttributeValueIcon">
                <property name="attributeName" class="ptolemy.kernel.util.StringAttribute" value="factor">
                </property>
            </property>
            <property name="_location" class="ptolemy.kernel.util.Location" value="[500.0, 250.0]">
            </property>
        </entity>
        <relation name="relation" class="ptolemy.actor.TypedIORelation">
            <vertex name="vertex1" value="[165.486328125, 249.501953125]">
            </vertex>
        </relation>
        <relation name="relation3" class="ptolemy.actor.TypedIORelation">
            <vertex name="vertex1" value="[585.0, 195.0]">
            </vertex>
        </relation>
        <relation name="relation7" class="ptolemy.actor.TypedIORelation">
            <vertex name="vertex1" value="[295.486328125, 249.501953125]">
            </vertex>
        </relation>
        <relation name="relation5" class="ptolemy.actor.TypedIORelation">
        </relation>
        <relation name="relation6" class="ptolemy.actor.TypedIORelation">
        </relation>
        <relation name="relation9" class="ptolemy.actor.TypedIORelation">
        </relation>
        <relation name="relation10" class="ptolemy.actor.TypedIORelation">
        </relation>
        <relation name="relation2" class="ptolemy.actor.TypedIORelation">
        </relation>
        <relation name="relation4" class="ptolemy.actor.TypedIORelation">
        </relation>
        <link port="x" relation="relation5"/>
        <link port="y" relation="relation6"/>
        <link port="theta" relation="relation7"/>
        <link port="theta_dot" relation="relation"/>
        <link port="theta_dot.derivative" relation="relation3"/>
        <link port="theta_dot.state" relation="relation"/>
        <link port="theta.derivative" relation="relation"/>
        <link port="theta.state" relation="relation7"/>
        <link port="Expression.output" relation="relation4"/>
        <link port="Expression.theta" relation="relation7"/>
        <link port="PolarToCartesian.magnitude" relation="relation2"/>
        <link port="PolarToCartesian.angle" relation="relation7"/>
        <link port="PolarToCartesian.x" relation="relation9"/>
        <link port="PolarToCartesian.y" relation="relation10"/>
        <link port="Const.output" relation="relation2"/>
        <link port="x position.output" relation="relation5"/>
        <link port="x position.in" relation="relation10"/>
        <link port="y position.output" relation="relation6"/>
        <link port="y position.in" relation="relation9"/>
        <link port="Scale.input" relation="relation4"/>
        <link port="Scale.output" relation="relation3"/>
    </class>
    <entity name="ball 1" class="ptolemy.domains.modal.modal.ModalModel">
        <property name="_tableauFactory" class="ptolemy.vergil.modal.modal.ModalTableauFactory">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[130.0, 305.0]">
        </property>
        <property name="initialTheta" class="ptolemy.data.expr.Parameter" value="initialTheta1">
        </property>
        <property name="initialTheta_dot" class="ptolemy.data.expr.Parameter" value="initialTheta_1_dot">
        </property>
        <property name="x_offset" class="ptolemy.data.expr.Parameter" value="0">
        </property>
        <port name="x_left" class="ptolemy.domains.modal.modal.ModalPort">
            <property name="input"/>
            <property name="_cardinal" class="ptolemy.kernel.util.StringAttribute" value="WEST">
            </property>
            <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
        </port>
        <port name="theta_left_dot" class="ptolemy.domains.modal.modal.ModalPort">
            <property name="input"/>
            <property name="_cardinal" class="ptolemy.kernel.util.StringAttribute" value="WEST">
            </property>
            <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
        </port>
        <port name="x_right" class="ptolemy.domains.modal.modal.ModalPort">
            <property name="input"/>
            <property name="_cardinal" class="ptolemy.kernel.util.StringAttribute" value="NORTH">
            </property>
            <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
        </port>
        <port name="theta_right_dot" class="ptolemy.domains.modal.modal.ModalPort">
            <property name="input"/>
            <property name="_cardinal" class="ptolemy.kernel.util.StringAttribute" value="SOUTH">
            </property>
            <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
        </port>
        <port name="x" class="ptolemy.domains.modal.modal.ModalPort">
            <property name="output"/>
            <property name="_cardinal" class="ptolemy.kernel.util.StringAttribute" value="EAST">
            </property>
            <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
        </port>
        <port name="theta_dot" class="ptolemy.domains.modal.modal.ModalPort">
            <property name="output"/>
            <property name="_cardinal" class="ptolemy.kernel.util.StringAttribute" value="EAST">
            </property>
            <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
        </port>
        <entity name="_Controller" class="ptolemy.domains.modal.modal.ModalController">
            <property name="_library" class="ptolemy.moml.LibraryAttribute">
                <configure>
        <entity name="state library" class="ptolemy.kernel.CompositeEntity"><input source="ptolemy/configs/basicUtilities.xml"></input><entity name="state" class="ptolemy.domains.modal.kernel.State"><property name="_centerName" class="ptolemy.kernel.util.Attribute"></property><property name="_controllerFactory" class="ptolemy.vergil.modal.modal.HierarchicalStateControllerFactory"></property></entity></entity>
      </configure>
            </property>
            <property name="annotation" class="ptolemy.kernel.util.Attribute">
                <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
                </property>
                <property name="_iconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
                    <configure><svg><text x="20" y="20" style="font-size:14; font-family:SansSerif; fill:blue">The transition from the init state to the run state initializes the positions and velocities of the
balls. A transition is taken from the run state back to itself when a collision occurs.  A collision
occurs when two adjacent balls make contact with velocity greater than zero. The collision is
perfectly elastic, so since the two balls have the same mass, they simply exchange their velocities.

In this example, the first collision happens when ball 1 reaches its equilibrium point. Although balls
2 and 3 have contact initially, because the collision happens instantaneously, only balls 1 and 2 will
be involved in the collision, so they exchange their velocities. After this collision, without any time
elapsing, balls 2 and 3 collide and exchange their velocities. Thus, two simultaneous yet ordered
transitions occur at the time of the collision.</text></svg></configure>
                </property>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[-10.0, 0.0]">
                </property>
                <property name="_controllerFactory" class="ptolemy.vergil.basic.NodeControllerFactory">
                </property>
                <property name="_editorFactory" class="ptolemy.vergil.toolbox.AnnotationEditorFactory">
                </property>
            </property>
            <property name="_windowProperties" class="ptolemy.actor.gui.WindowPropertiesAttribute" value="{bounds={499, 296, 922, 607}, maximized=false}">
            </property>
            <property name="_vergilSize" class="ptolemy.actor.gui.SizeAttribute" value="[707, 490]">
            </property>
            <property name="_vergilZoomFactor" class="ptolemy.data.expr.ExpertParameter" value="1.0">
            </property>
            <property name="_vergilCenter" class="ptolemy.data.expr.ExpertParameter" value="{353.5, 245.0}">
            </property>
            <port name="x_left" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="input"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[415.0, 370.0]">
                </property>
            </port>
            <port name="theta_left_dot" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="input"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[415.0, 320.0]">
                </property>
            </port>
            <port name="x_right" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="input"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[530.0, 320.0]">
                </property>
            </port>
            <port name="theta_right_dot" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="input"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[530.0, 370.0]">
                </property>
            </port>
            <port name="x" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="input"/>
                <property name="output"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[645.0, 370.0]">
                </property>
            </port>
            <port name="theta_dot" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="input"/>
                <property name="output"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[645.0, 320.0]">
                </property>
            </port>
            <entity name="state" class="ptolemy.domains.modal.kernel.State">
                <property name="refinementName" class="ptolemy.kernel.util.StringAttribute" value="state">
                </property>
                <property name="isInitialState" class="ptolemy.data.expr.Parameter" value="false">
                </property>
                <property name="_hideName" class="ptolemy.data.expr.SingletonParameter" value="true">
                </property>
                <property name="_controllerFactory" class="ptolemy.vergil.modal.modal.HierarchicalStateControllerFactory">
                </property>
                <property name="_location" class="ptolemy.kernel.util.Location" value="{260.0, 265.0}">
                </property>
            </entity>
            <entity name="init" class="ptolemy.domains.modal.kernel.State">
                <property name="isInitialState" class="ptolemy.data.expr.Parameter" value="true">
                </property>
                <property name="_hideName" class="ptolemy.data.expr.SingletonParameter" value="true">
                </property>
                <property name="_controllerFactory" class="ptolemy.vergil.modal.modal.HierarchicalStateControllerFactory">
                </property>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[226.29031984213864, 189.49999618530282]">
                </property>
            </entity>
            <relation name="relation" class="ptolemy.domains.modal.kernel.Transition">
                <property name="guardExpression" class="ptolemy.kernel.util.StringAttribute" value="x_right_isPresent &#10;  &amp;&amp; theta_right_dot_isPresent &#10;  &amp;&amp; ((x + diameter) &gt;= x_right) &#10;  &amp;&amp; (theta_dot &gt; theta_right_dot)">
                    <property name="style" class="ptolemy.actor.gui.style.TextStyle">
                        <property name="height" class="ptolemy.data.expr.Parameter" value="10">
                        </property>
                        <property name="width" class="ptolemy.data.expr.Parameter" value="30">
                        </property>
                    </property>
                </property>
                <property name="setActions" class="ptolemy.domains.modal.kernel.CommitActionsAttribute" value="&#10;  state.theta_dot_initial = theta_right_dot">
                    <property name="style" class="ptolemy.actor.gui.style.TextStyle">
                        <property name="height" class="ptolemy.data.expr.Parameter" value="10">
                        </property>
                        <property name="width" class="ptolemy.data.expr.Parameter" value="30">
                        </property>
                    </property>
                </property>
                <property name="exitAngle" class="ptolemy.data.expr.Parameter" value="2.260991363440288">
                </property>
                <property name="gamma" class="ptolemy.data.expr.Parameter" value="0.3947358055295304">
                </property>
                <property name="reset" class="ptolemy.data.expr.Parameter" value="false">
                </property>
                <property name="preemptive" class="ptolemy.data.expr.Parameter" value="false">
                </property>
                <property name="nondeterministic" class="ptolemy.data.expr.Parameter" value="true">
                </property>
            </relation>
            <relation name="relation3" class="ptolemy.domains.modal.kernel.Transition">
                <property name="guardExpression" class="ptolemy.kernel.util.StringAttribute" value="x_left_isPresent&#10;  &amp;&amp; theta_left_dot_isPresent &#10;  &amp;&amp; ((x_left + diameter) &gt;= x) &#10;  &amp;&amp; (theta_left_dot &gt; theta_dot)">
                    <property name="style" class="ptolemy.actor.gui.style.TextStyle">
                        <property name="height" class="ptolemy.data.expr.Parameter" value="10">
                        </property>
                        <property name="width" class="ptolemy.data.expr.Parameter" value="30">
                        </property>
                    </property>
                </property>
                <property name="setActions" class="ptolemy.domains.modal.kernel.CommitActionsAttribute" value="&#10;  state.theta_dot_initial = theta_left_dot">
                    <property name="style" class="ptolemy.actor.gui.style.TextStyle">
                        <property name="height" class="ptolemy.data.expr.Parameter" value="10">
                        </property>
                        <property name="width" class="ptolemy.data.expr.Parameter" value="30">
                        </property>
                    </property>
                </property>
                <property name="exitAngle" class="ptolemy.data.expr.Parameter" value="2.234717179630848">
                </property>
                <property name="gamma" class="ptolemy.data.expr.Parameter" value="-1.8936885273278177">
                </property>
                <property name="reset" class="ptolemy.data.expr.Parameter" value="false">
                </property>
                <property name="preemptive" class="ptolemy.data.expr.Parameter" value="false">
                </property>
                <property name="nondeterministic" class="ptolemy.data.expr.Parameter" value="true">
                </property>
            </relation>
            <relation name="relation4" class="ptolemy.domains.modal.kernel.Transition">
                <property name="guardExpression" class="ptolemy.kernel.util.StringAttribute" value="true">
                </property>
                <property name="outputActions" class="ptolemy.domains.modal.kernel.OutputActionsAttribute" value="&#10;  theta_dot = initialTheta_dot;&#10;  x = length * sin(initialTheta) + x_offset">
                </property>
                <property name="setActions" class="ptolemy.domains.modal.kernel.CommitActionsAttribute" value="&#10;  state.theta_dot_initial = initialTheta_dot;&#10;  state.theta_initial = initialTheta&#10;">
                </property>
                <property name="exitAngle" class="ptolemy.data.expr.Parameter" value="0.6283185307179586">
                </property>
                <property name="gamma" class="ptolemy.data.expr.Parameter" value="1.3724043067691258">
                </property>
            </relation>
            <link port="state.incomingPort" relation="relation"/>
            <link port="state.incomingPort" relation="relation3"/>
            <link port="state.incomingPort" relation="relation4"/>
            <link port="state.outgoingPort" relation="relation"/>
            <link port="state.outgoingPort" relation="relation3"/>
            <link port="init.outgoingPort" relation="relation4"/>
        </entity>
        <entity name="state" class="ptolemy.domains.modal.modal.Refinement">
            <property name="_windowProperties" class="ptolemy.actor.gui.WindowPropertiesAttribute" value="{bounds={48, 223, 815, 517}, maximized=false}">
            </property>
            <property name="_vergilSize" class="ptolemy.actor.gui.SizeAttribute" value="[600, 400]">
            </property>
            <property name="_vergilZoomFactor" class="ptolemy.data.expr.ExpertParameter" value="1.0">
            </property>
            <property name="_vergilCenter" class="ptolemy.data.expr.ExpertParameter" value="{300.0, 200.0}">
            </property>
            <property name="theta_dot_initial" class="ptolemy.data.expr.Parameter" value="-0.4303900617505">
                <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
                </property>
                <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
                    <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
                    </property>
                </property>
                <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
                    <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
                </property>
                <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
                </property>
                <property name="_location" class="ptolemy.kernel.util.Location" value="{30.0, 135.0}">
                </property>
            </property>
            <property name="theta_initial" class="ptolemy.data.expr.Parameter" value="-0.3926990816987">
                <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
                </property>
                <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
                    <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
                    </property>
                </property>
                <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
                    <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
                </property>
                <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
                </property>
                <property name="_location" class="ptolemy.kernel.util.Location" value="{30.0, 110.0}">
                </property>
            </property>
            <property name="Continuous Director" class="ptolemy.domains.continuous.kernel.ContinuousDirector">
                <property name="stopTime" class="ptolemy.data.expr.Parameter" value="Infinity">
                </property>
                <property name="_location" class="ptolemy.kernel.util.Location" value="{110.0, 60.0}">
                </property>
            </property>
            <port name="x_left" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="input"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[482.9375, 201.66666666666666]">
                </property>
            </port>
            <port name="theta_left_dot" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="input"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[460.0, 255.0]">
                </property>
            </port>
            <port name="x_right" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="input"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[478.9375, 308.33333333333337]">
                </property>
            </port>
            <port name="theta_right_dot" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="input"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[456.0, 361.6666666666667]">
                </property>
            </port>
            <port name="x" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="output"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[295.0, 210.0]">
                </property>
            </port>
            <port name="theta_dot" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="output"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[295.0, 250.0]">
                </property>
            </port>
            <entity name="BallDynamics" class="BallClass">
                <property name="_location" class="ptolemy.kernel.util.Location" value="[125.0, 230.0]">
                </property>
                <property name="initialTheta" class="ptolemy.actor.parameters.PortParameter" value="theta_initial">
                </property>
                <property name="initialTheta_dot" class="ptolemy.actor.parameters.PortParameter" value="theta_dot_initial">
                </property>
                <property name="x_offset" class="ptolemy.data.expr.Parameter" value="x_offset">
                </property>
                <property name="MechanicsUnitsOntologySolver::constraint3" class="ptolemy.data.ontologies.OntologyAnnotationAttribute" value="Expression.output &gt;= Dimensionless">
                    <property name="_location" class="ptolemy.kernel.util.Location" value="[30.0, 480.0]">
                    </property>
                </property>
                <port name="initialTheta" class="ptolemy.actor.parameters.ParameterPort">
                    <property name="input"/>
                    <property name="_location" class="ptolemy.kernel.util.Location" value="{225.0, 30.0}">
                    </property>
                </port>
                <port name="initialTheta_dot" class="ptolemy.actor.parameters.ParameterPort">
                    <property name="input"/>
                    <property name="_location" class="ptolemy.kernel.util.Location" value="{225.0, 60.0}">
                    </property>
                </port>
            </entity>
            <relation name="relation3" class="ptolemy.actor.TypedIORelation">
            </relation>
            <relation name="relation" class="ptolemy.actor.TypedIORelation">
            </relation>
            <link port="x" relation="relation3"/>
            <link port="theta_dot" relation="relation"/>
            <link port="BallDynamics.x" relation="relation3"/>
            <link port="BallDynamics.theta_dot" relation="relation"/>
        </entity>
        <relation name="x_leftRelation" class="ptolemy.actor.TypedIORelation">
        </relation>
        <relation name="theta_left_dotRelation" class="ptolemy.actor.TypedIORelation">
        </relation>
        <relation name="x_rightRelation" class="ptolemy.actor.TypedIORelation">
        </relation>
        <relation name="theta_right_dotRelation" class="ptolemy.actor.TypedIORelation">
        </relation>
        <relation name="xRelation" class="ptolemy.actor.TypedIORelation">
        </relation>
        <relation name="theta_dotRelation" class="ptolemy.actor.TypedIORelation">
        </relation>
        <link port="x_left" relation="x_leftRelation"/>
        <link port="theta_left_dot" relation="theta_left_dotRelation"/>
        <link port="x_right" relation="x_rightRelation"/>
        <link port="theta_right_dot" relation="theta_right_dotRelation"/>
        <link port="x" relation="xRelation"/>
        <link port="theta_dot" relation="theta_dotRelation"/>
        <link port="_Controller.x_left" relation="x_leftRelation"/>
        <link port="_Controller.theta_left_dot" relation="theta_left_dotRelation"/>
        <link port="_Controller.x_right" relation="x_rightRelation"/>
        <link port="_Controller.theta_right_dot" relation="theta_right_dotRelation"/>
        <link port="_Controller.x" relation="xRelation"/>
        <link port="_Controller.theta_dot" relation="theta_dotRelation"/>
        <link port="state.x_left" relation="x_leftRelation"/>
        <link port="state.theta_left_dot" relation="theta_left_dotRelation"/>
        <link port="state.x_right" relation="x_rightRelation"/>
        <link port="state.theta_right_dot" relation="theta_right_dotRelation"/>
        <link port="state.x" relation="xRelation"/>
        <link port="state.theta_dot" relation="theta_dotRelation"/>
    </entity>
    <entity name="ball 3" class="ptolemy.domains.modal.modal.ModalModel">
        <property name="_tableauFactory" class="ptolemy.vergil.modal.modal.ModalTableauFactory">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[475.0, 305.0]">
        </property>
        <property name="initialTheta" class="ptolemy.data.expr.Parameter" value="initialTheta3">
        </property>
        <property name="initialTheta_dot" class="ptolemy.data.expr.Parameter" value="initialTheta_3_dot">
        </property>
        <property name="x_offset" class="ptolemy.data.expr.Parameter" value="2*diameter">
        </property>
        <port name="x_left" class="ptolemy.domains.modal.modal.ModalPort">
            <property name="input"/>
            <property name="_cardinal" class="ptolemy.kernel.util.StringAttribute" value="NORTH">
            </property>
            <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
        </port>
        <port name="theta_left_dot" class="ptolemy.domains.modal.modal.ModalPort">
            <property name="input"/>
            <property name="_cardinal" class="ptolemy.kernel.util.StringAttribute" value="SOUTH">
            </property>
            <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
        </port>
        <port name="x_right" class="ptolemy.domains.modal.modal.ModalPort">
            <property name="input"/>
            <property name="_cardinal" class="ptolemy.kernel.util.StringAttribute" value="EAST">
            </property>
            <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
        </port>
        <port name="theta_right_dot" class="ptolemy.domains.modal.modal.ModalPort">
            <property name="input"/>
            <property name="_cardinal" class="ptolemy.kernel.util.StringAttribute" value="EAST">
            </property>
            <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
        </port>
        <port name="x" class="ptolemy.domains.modal.modal.ModalPort">
            <property name="output"/>
            <property name="_cardinal" class="ptolemy.kernel.util.StringAttribute" value="WEST">
            </property>
            <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
        </port>
        <port name="theta_dot" class="ptolemy.domains.modal.modal.ModalPort">
            <property name="output"/>
            <property name="_cardinal" class="ptolemy.kernel.util.StringAttribute" value="WEST">
            </property>
            <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
        </port>
        <entity name="_Controller" class="ptolemy.domains.modal.modal.ModalController">
            <property name="_library" class="ptolemy.moml.LibraryAttribute">
                <configure>
        <entity name="state library" class="ptolemy.kernel.CompositeEntity"><input source="ptolemy/configs/basicUtilities.xml"></input><entity name="state" class="ptolemy.domains.modal.kernel.State"><property name="_centerName" class="ptolemy.kernel.util.Attribute"></property><property name="_controllerFactory" class="ptolemy.vergil.modal.modal.HierarchicalStateControllerFactory"></property></entity></entity>
      </configure>
            </property>
            <property name="annotation" class="ptolemy.kernel.util.Attribute">
                <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
                </property>
                <property name="_iconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
                    <configure><svg><text x="20" y="20" style="font-size:14; font-family:SansSerif; fill:blue">The transition from the init state to the run state initializes the positions and velocities of the
balls. A transition is taken from the run state back to itself when a collision occurs.  A collision
occurs when two adjascent balls make contact with velocity greater than zero. The collision is
perfectly elastic, so since the two balls have the same mass, they simply exchange their velocities.

In this example, the first collision happens when ball 1 reaches its equilibrium point. Although balls
2 and 3 have contact initially, because the collision happens instantaneously, only balls 1 and 2 will
be involved in the collision, so they exchange their velocities. After this collision, without any time
elapsing, balls 2 and 3 collide and exchange their velocities. Thus, two simultaneous yet ordered
transitions occur at the time of the collision.</text></svg></configure>
                </property>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[-15.0, 0.0]">
                </property>
                <property name="_controllerFactory" class="ptolemy.vergil.basic.NodeControllerFactory">
                </property>
                <property name="_editorFactory" class="ptolemy.vergil.toolbox.AnnotationEditorFactory">
                </property>
            </property>
            <property name="_windowProperties" class="ptolemy.actor.gui.WindowPropertiesAttribute" value="{bounds={492, 334, 935, 532}, maximized=false}">
            </property>
            <property name="_vergilSize" class="ptolemy.actor.gui.SizeAttribute" value="[720, 415]">
            </property>
            <property name="_vergilZoomFactor" class="ptolemy.data.expr.ExpertParameter" value="1.0">
            </property>
            <property name="_vergilCenter" class="ptolemy.data.expr.ExpertParameter" value="{360.0, 207.5}">
            </property>
            <port name="x_left" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="input"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[405.0, 370.0]">
                </property>
            </port>
            <port name="theta_left_dot" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="input"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[405.0, 320.0]">
                </property>
            </port>
            <port name="x_right" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="input"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[500.0, 320.0]">
                </property>
            </port>
            <port name="theta_right_dot" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="input"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[500.0, 370.0]">
                </property>
            </port>
            <port name="x" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="input"/>
                <property name="output"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[605.0, 370.0]">
                </property>
            </port>
            <port name="theta_dot" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="input"/>
                <property name="output"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[605.0, 320.0]">
                </property>
            </port>
            <entity name="state" class="ptolemy.domains.modal.kernel.State">
                <property name="refinementName" class="ptolemy.kernel.util.StringAttribute" value="state">
                </property>
                <property name="isInitialState" class="ptolemy.data.expr.Parameter" value="false">
                </property>
                <property name="_hideName" class="ptolemy.data.expr.SingletonParameter" value="true">
                </property>
                <property name="_controllerFactory" class="ptolemy.vergil.modal.modal.HierarchicalStateControllerFactory">
                </property>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[261.2903198421386, 264.49999618530285]">
                </property>
            </entity>
            <entity name="init" class="ptolemy.domains.modal.kernel.State">
                <property name="isInitialState" class="ptolemy.data.expr.Parameter" value="true">
                </property>
                <property name="_hideName" class="ptolemy.data.expr.SingletonParameter" value="true">
                </property>
                <property name="_controllerFactory" class="ptolemy.vergil.modal.modal.HierarchicalStateControllerFactory">
                </property>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[226.29031984213864, 189.49999618530282]">
                </property>
            </entity>
            <relation name="relation" class="ptolemy.domains.modal.kernel.Transition">
                <property name="guardExpression" class="ptolemy.kernel.util.StringAttribute" value="x_right_isPresent &amp;&amp; theta_right_dot_isPresent &#10;&amp;&amp; ((x + diameter) &gt;= x_right) &#10;  &amp;&amp; (theta_dot &gt; theta_right_dot)">
                    <property name="style" class="ptolemy.actor.gui.style.TextStyle">
                        <property name="height" class="ptolemy.data.expr.Parameter" value="10">
                        </property>
                        <property name="width" class="ptolemy.data.expr.Parameter" value="30">
                        </property>
                    </property>
                </property>
                <property name="setActions" class="ptolemy.domains.modal.kernel.CommitActionsAttribute" value="&#10;state.theta_dot_initial = theta_right_dot">
                    <property name="style" class="ptolemy.actor.gui.style.TextStyle">
                        <property name="height" class="ptolemy.data.expr.Parameter" value="10">
                        </property>
                        <property name="width" class="ptolemy.data.expr.Parameter" value="30">
                        </property>
                    </property>
                </property>
                <property name="exitAngle" class="ptolemy.data.expr.Parameter" value="2.260991363440288">
                </property>
                <property name="gamma" class="ptolemy.data.expr.Parameter" value="0.3947358055295304">
                </property>
                <property name="reset" class="ptolemy.data.expr.Parameter" value="false">
                </property>
                <property name="preemptive" class="ptolemy.data.expr.Parameter" value="false">
                </property>
                <property name="nondeterministic" class="ptolemy.data.expr.Parameter" value="true">
                </property>
            </relation>
            <relation name="relation3" class="ptolemy.domains.modal.kernel.Transition">
                <property name="guardExpression" class="ptolemy.kernel.util.StringAttribute" value="x_left_isPresent &amp;&amp; theta_left_dot_isPresent &#10;&amp;&amp; ((x_left + diameter) &gt;= x) &#10;  &amp;&amp; (theta_left_dot &gt; theta_dot)">
                    <property name="style" class="ptolemy.actor.gui.style.TextStyle">
                        <property name="height" class="ptolemy.data.expr.Parameter" value="10">
                        </property>
                        <property name="width" class="ptolemy.data.expr.Parameter" value="30">
                        </property>
                    </property>
                </property>
                <property name="setActions" class="ptolemy.domains.modal.kernel.CommitActionsAttribute" value="&#10;state.theta_dot_initial = theta_left_dot">
                    <property name="style" class="ptolemy.actor.gui.style.TextStyle">
                        <property name="height" class="ptolemy.data.expr.Parameter" value="10">
                        </property>
                        <property name="width" class="ptolemy.data.expr.Parameter" value="30">
                        </property>
                    </property>
                </property>
                <property name="exitAngle" class="ptolemy.data.expr.Parameter" value="2.234717179630848">
                </property>
                <property name="gamma" class="ptolemy.data.expr.Parameter" value="-1.8936885273278177">
                </property>
                <property name="reset" class="ptolemy.data.expr.Parameter" value="false">
                </property>
                <property name="preemptive" class="ptolemy.data.expr.Parameter" value="false">
                </property>
                <property name="nondeterministic" class="ptolemy.data.expr.Parameter" value="true">
                </property>
            </relation>
            <relation name="relation4" class="ptolemy.domains.modal.kernel.Transition">
                <property name="guardExpression" class="ptolemy.kernel.util.StringAttribute" value="true">
                </property>
                <property name="outputActions" class="ptolemy.domains.modal.kernel.OutputActionsAttribute" value="&#10;  theta_dot = initialTheta_dot;&#10;  x = length * sin(initialTheta) + x_offset">
                </property>
                <property name="setActions" class="ptolemy.domains.modal.kernel.CommitActionsAttribute" value="&#10;  state.theta_dot_initial = initialTheta_dot;&#10;  state.theta_initial = initialTheta">
                </property>
                <property name="exitAngle" class="ptolemy.data.expr.Parameter" value="0.6283185307179586">
                </property>
                <property name="gamma" class="ptolemy.data.expr.Parameter" value="1.3628682681279694">
                </property>
            </relation>
            <link port="state.incomingPort" relation="relation"/>
            <link port="state.incomingPort" relation="relation3"/>
            <link port="state.incomingPort" relation="relation4"/>
            <link port="state.outgoingPort" relation="relation"/>
            <link port="state.outgoingPort" relation="relation3"/>
            <link port="init.outgoingPort" relation="relation4"/>
        </entity>
        <entity name="state" class="ptolemy.domains.modal.modal.Refinement">
            <property name="_windowProperties" class="ptolemy.actor.gui.WindowPropertiesAttribute" value="{bounds={611, 211, 815, 517}, maximized=false}">
            </property>
            <property name="_vergilSize" class="ptolemy.actor.gui.SizeAttribute" value="[600, 400]">
            </property>
            <property name="_vergilZoomFactor" class="ptolemy.data.expr.ExpertParameter" value="1.0">
            </property>
            <property name="_vergilCenter" class="ptolemy.data.expr.ExpertParameter" value="{300.0, 200.0}">
            </property>
            <property name="theta_dot_initial" class="ptolemy.data.expr.Parameter" value="2.330064284737989E-5">
                <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
                </property>
                <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
                    <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
                    </property>
                </property>
                <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
                    <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
                </property>
                <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
                </property>
                <property name="_location" class="ptolemy.kernel.util.Location" value="{30.0, 135.0}">
                </property>
            </property>
            <property name="theta_initial" class="ptolemy.data.expr.Parameter" value="0.0">
                <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
                </property>
                <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
                    <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
                    </property>
                </property>
                <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
                    <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
                </property>
                <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
                </property>
                <property name="_location" class="ptolemy.kernel.util.Location" value="{30.0, 110.0}">
                </property>
            </property>
            <property name="Continuous Director" class="ptolemy.domains.continuous.kernel.ContinuousDirector">
                <property name="stopTime" class="ptolemy.data.expr.Parameter" value="Infinity">
                </property>
                <property name="_location" class="ptolemy.kernel.util.Location" value="{110.0, 60.0}">
                </property>
            </property>
            <port name="x_left" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="input"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[482.9375, 201.66666666666666]">
                </property>
            </port>
            <port name="theta_left_dot" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="input"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[460.0, 255.0]">
                </property>
            </port>
            <port name="x_right" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="input"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[478.9375, 308.33333333333337]">
                </property>
            </port>
            <port name="theta_right_dot" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="input"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[456.0, 361.6666666666667]">
                </property>
            </port>
            <port name="x" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="output"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[295.0, 210.0]">
                </property>
            </port>
            <port name="theta_dot" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="output"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[295.0, 250.0]">
                </property>
            </port>
            <entity name="BallDynamics" class="BallClass">
                <property name="_location" class="ptolemy.kernel.util.Location" value="[135.0, 230.0]">
                </property>
                <property name="initialTheta" class="ptolemy.actor.parameters.PortParameter" value="theta_initial">
                </property>
                <property name="initialTheta_dot" class="ptolemy.actor.parameters.PortParameter" value="theta_dot_initial">
                </property>
                <property name="x_offset" class="ptolemy.data.expr.Parameter" value="x_offset">
                </property>
                <port name="initialTheta" class="ptolemy.actor.parameters.ParameterPort">
                    <property name="input"/>
                    <property name="_location" class="ptolemy.kernel.util.Location" value="{225.0, 30.0}">
                    </property>
                </port>
                <port name="initialTheta_dot" class="ptolemy.actor.parameters.ParameterPort">
                    <property name="input"/>
                    <property name="_location" class="ptolemy.kernel.util.Location" value="{225.0, 60.0}">
                    </property>
                </port>
            </entity>
            <relation name="relation" class="ptolemy.actor.TypedIORelation">
            </relation>
            <relation name="relation2" class="ptolemy.actor.TypedIORelation">
            </relation>
            <link port="x" relation="relation"/>
            <link port="theta_dot" relation="relation2"/>
            <link port="BallDynamics.x" relation="relation"/>
            <link port="BallDynamics.theta_dot" relation="relation2"/>
        </entity>
        <relation name="x_leftRelation" class="ptolemy.actor.TypedIORelation">
        </relation>
        <relation name="theta_left_dotRelation" class="ptolemy.actor.TypedIORelation">
        </relation>
        <relation name="x_rightRelation" class="ptolemy.actor.TypedIORelation">
        </relation>
        <relation name="theta_right_dotRelation" class="ptolemy.actor.TypedIORelation">
        </relation>
        <relation name="xRelation" class="ptolemy.actor.TypedIORelation">
        </relation>
        <relation name="theta_dotRelation" class="ptolemy.actor.TypedIORelation">
        </relation>
        <link port="x_left" relation="x_leftRelation"/>
        <link port="theta_left_dot" relation="theta_left_dotRelation"/>
        <link port="x_right" relation="x_rightRelation"/>
        <link port="theta_right_dot" relation="theta_right_dotRelation"/>
        <link port="x" relation="xRelation"/>
        <link port="theta_dot" relation="theta_dotRelation"/>
        <link port="_Controller.x_left" relation="x_leftRelation"/>
        <link port="_Controller.theta_left_dot" relation="theta_left_dotRelation"/>
        <link port="_Controller.x_right" relation="x_rightRelation"/>
        <link port="_Controller.theta_right_dot" relation="theta_right_dotRelation"/>
        <link port="_Controller.x" relation="xRelation"/>
        <link port="_Controller.theta_dot" relation="theta_dotRelation"/>
        <link port="state.x_left" relation="x_leftRelation"/>
        <link port="state.theta_left_dot" relation="theta_left_dotRelation"/>
        <link port="state.x_right" relation="x_rightRelation"/>
        <link port="state.theta_right_dot" relation="theta_right_dotRelation"/>
        <link port="state.x" relation="xRelation"/>
        <link port="state.theta_dot" relation="theta_dotRelation"/>
    </entity>
    <entity name="ball 2" class="ptolemy.domains.modal.modal.ModalModel">
        <property name="_tableauFactory" class="ptolemy.vergil.modal.modal.ModalTableauFactory">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[295.0, 305.0]">
        </property>
        <property name="initialTheta" class="ptolemy.data.expr.Parameter" value="initialTheta2">
        </property>
        <property name="initialTheta_dot" class="ptolemy.data.expr.Parameter" value="initialTheta_2_dot">
        </property>
        <property name="x_offset" class="ptolemy.data.expr.Parameter" value="diameter">
        </property>
        <port name="x_left" class="ptolemy.domains.modal.modal.ModalPort">
            <property name="input"/>
            <property name="_cardinal" class="ptolemy.kernel.util.StringAttribute" value="WEST">
            </property>
            <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
        </port>
        <port name="theta_left_dot" class="ptolemy.domains.modal.modal.ModalPort">
            <property name="input"/>
            <property name="_cardinal" class="ptolemy.kernel.util.StringAttribute" value="WEST">
            </property>
            <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
        </port>
        <port name="x_right" class="ptolemy.domains.modal.modal.ModalPort">
            <property name="input"/>
            <property name="_cardinal" class="ptolemy.kernel.util.StringAttribute" value="EAST">
            </property>
            <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
        </port>
        <port name="theta_right_dot" class="ptolemy.domains.modal.modal.ModalPort">
            <property name="input"/>
            <property name="_cardinal" class="ptolemy.kernel.util.StringAttribute" value="EAST">
            </property>
            <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
        </port>
        <port name="x" class="ptolemy.domains.modal.modal.ModalPort">
            <property name="output"/>
            <property name="_cardinal" class="ptolemy.kernel.util.StringAttribute" value="NORTH">
            </property>
            <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
        </port>
        <port name="theta_dot" class="ptolemy.domains.modal.modal.ModalPort">
            <property name="output"/>
            <property name="_cardinal" class="ptolemy.kernel.util.StringAttribute" value="SOUTH">
            </property>
            <property name="_showName" class="ptolemy.data.expr.SingletonParameter" value="true">
            </property>
        </port>
        <entity name="_Controller" class="ptolemy.domains.modal.modal.ModalController">
            <property name="_library" class="ptolemy.moml.LibraryAttribute">
                <configure>
        <entity name="state library" class="ptolemy.kernel.CompositeEntity"><input source="ptolemy/configs/basicUtilities.xml"></input><entity name="state" class="ptolemy.domains.modal.kernel.State"><property name="_centerName" class="ptolemy.kernel.util.Attribute"></property><property name="_controllerFactory" class="ptolemy.vergil.modal.modal.HierarchicalStateControllerFactory"></property></entity></entity>
      </configure>
            </property>
            <property name="annotation" class="ptolemy.kernel.util.Attribute">
                <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
                </property>
                <property name="_iconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
                    <configure><svg><text x="20" y="20" style="font-size:14; font-family:SansSerif; fill:blue">The transition from the init state to the run state initializes the positions and velocities of the
balls. A transition is taken from the run state back to itself when a collision occurs.  A collision
occurs when two adjascent balls make contact with velocity greater than zero. The collision is
perfectly elastic, so since the two balls have the same mass, they simply exchange their velocities.

In this example, the first collision happens when ball 1 reaches its equilibrium point. Although balls
2 and 3 have contact initially, because the collision happens instantaneously, only balls 1 and 2 will
be involved in the collision, so they exchange their velocities. After this collision, without any time
elapsing, balls 2 and 3 collide and exchange their velocities. Thus, two simultaneous yet ordered
transitions occur at the time of the collision.</text></svg></configure>
                </property>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[-5.0, 0.0]">
                </property>
                <property name="_controllerFactory" class="ptolemy.vergil.basic.NodeControllerFactory">
                </property>
                <property name="_editorFactory" class="ptolemy.vergil.toolbox.AnnotationEditorFactory">
                </property>
            </property>
            <property name="_windowProperties" class="ptolemy.actor.gui.WindowPropertiesAttribute" value="{bounds={461, 313, 998, 574}, maximized=false}">
            </property>
            <property name="_vergilSize" class="ptolemy.actor.gui.SizeAttribute" value="[783, 457]">
            </property>
            <property name="_vergilZoomFactor" class="ptolemy.data.expr.ExpertParameter" value="1.0">
            </property>
            <property name="_vergilCenter" class="ptolemy.data.expr.ExpertParameter" value="{391.5, 228.5}">
            </property>
            <port name="x_left" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="input"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[415.0, 370.0]">
                </property>
            </port>
            <port name="theta_left_dot" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="input"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[415.0, 320.0]">
                </property>
            </port>
            <port name="x_right" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="input"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[500.0, 320.0]">
                </property>
            </port>
            <port name="theta_right_dot" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="input"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[500.0, 370.0]">
                </property>
            </port>
            <port name="x" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="input"/>
                <property name="output"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[620.0, 370.0]">
                </property>
            </port>
            <port name="theta_dot" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="input"/>
                <property name="output"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[620.0, 320.0]">
                </property>
            </port>
            <entity name="state" class="ptolemy.domains.modal.kernel.State">
                <property name="refinementName" class="ptolemy.kernel.util.StringAttribute" value="state">
                </property>
                <property name="isInitialState" class="ptolemy.data.expr.Parameter" value="false">
                </property>
                <property name="_hideName" class="ptolemy.data.expr.SingletonParameter" value="true">
                </property>
                <property name="_controllerFactory" class="ptolemy.vergil.modal.modal.HierarchicalStateControllerFactory">
                </property>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[261.2903198421386, 264.49999618530285]">
                </property>
            </entity>
            <entity name="init" class="ptolemy.domains.modal.kernel.State">
                <property name="isInitialState" class="ptolemy.data.expr.Parameter" value="true">
                </property>
                <property name="_hideName" class="ptolemy.data.expr.SingletonParameter" value="true">
                </property>
                <property name="_controllerFactory" class="ptolemy.vergil.modal.modal.HierarchicalStateControllerFactory">
                </property>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[226.29031984213864, 189.49999618530282]">
                </property>
            </entity>
            <relation name="relation" class="ptolemy.domains.modal.kernel.Transition">
                <property name="guardExpression" class="ptolemy.kernel.util.StringAttribute" value="x_right_isPresent &amp;&amp; theta_right_dot_isPresent &#10;&amp;&amp; ((x + diameter) &gt;= x_right) &#10;  &amp;&amp; (theta_dot &gt; theta_right_dot)">
                    <property name="style" class="ptolemy.actor.gui.style.TextStyle">
                        <property name="height" class="ptolemy.data.expr.Parameter" value="10">
                        </property>
                        <property name="width" class="ptolemy.data.expr.Parameter" value="30">
                        </property>
                    </property>
                </property>
                <property name="setActions" class="ptolemy.domains.modal.kernel.CommitActionsAttribute" value="&#10;state.theta_dot_initial = theta_right_dot">
                    <property name="style" class="ptolemy.actor.gui.style.TextStyle">
                        <property name="height" class="ptolemy.data.expr.Parameter" value="10">
                        </property>
                        <property name="width" class="ptolemy.data.expr.Parameter" value="30">
                        </property>
                    </property>
                </property>
                <property name="exitAngle" class="ptolemy.data.expr.Parameter" value="2.260991363440288">
                </property>
                <property name="gamma" class="ptolemy.data.expr.Parameter" value="0.3947358055295304">
                </property>
                <property name="reset" class="ptolemy.data.expr.Parameter" value="false">
                </property>
                <property name="preemptive" class="ptolemy.data.expr.Parameter" value="false">
                </property>
                <property name="nondeterministic" class="ptolemy.data.expr.Parameter" value="true">
                </property>
            </relation>
            <relation name="relation3" class="ptolemy.domains.modal.kernel.Transition">
                <property name="guardExpression" class="ptolemy.kernel.util.StringAttribute" value="x_left_isPresent &amp;&amp; theta_left_dot_isPresent &#10;&amp;&amp; ((x_left + diameter) &gt;= x) &#10;  &amp;&amp; (theta_left_dot &gt; theta_dot)">
                    <property name="style" class="ptolemy.actor.gui.style.TextStyle">
                        <property name="height" class="ptolemy.data.expr.Parameter" value="10">
                        </property>
                        <property name="width" class="ptolemy.data.expr.Parameter" value="30">
                        </property>
                    </property>
                </property>
                <property name="setActions" class="ptolemy.domains.modal.kernel.CommitActionsAttribute" value="&#10;state.theta_dot_initial = theta_left_dot">
                    <property name="style" class="ptolemy.actor.gui.style.TextStyle">
                        <property name="height" class="ptolemy.data.expr.Parameter" value="10">
                        </property>
                        <property name="width" class="ptolemy.data.expr.Parameter" value="30">
                        </property>
                    </property>
                </property>
                <property name="exitAngle" class="ptolemy.data.expr.Parameter" value="2.234717179630848">
                </property>
                <property name="gamma" class="ptolemy.data.expr.Parameter" value="-1.8936885273278177">
                </property>
                <property name="reset" class="ptolemy.data.expr.Parameter" value="false">
                </property>
                <property name="preemptive" class="ptolemy.data.expr.Parameter" value="false">
                </property>
                <property name="nondeterministic" class="ptolemy.data.expr.Parameter" value="true">
                </property>
            </relation>
            <relation name="relation4" class="ptolemy.domains.modal.kernel.Transition">
                <property name="guardExpression" class="ptolemy.kernel.util.StringAttribute" value="true">
                </property>
                <property name="outputActions" class="ptolemy.domains.modal.kernel.OutputActionsAttribute" value="&#10;  theta_dot = initialTheta_dot;&#10;  x = length * sin(initialTheta) + x_offset">
                </property>
                <property name="setActions" class="ptolemy.domains.modal.kernel.CommitActionsAttribute" value="&#10;  state.theta_dot_initial = initialTheta_dot;&#10;  state.theta_initial = initialTheta&#10;">
                </property>
                <property name="exitAngle" class="ptolemy.data.expr.Parameter" value="0.6283185307179586">
                </property>
                <property name="gamma" class="ptolemy.data.expr.Parameter" value="1.3628682681279694">
                </property>
            </relation>
            <link port="state.incomingPort" relation="relation"/>
            <link port="state.incomingPort" relation="relation3"/>
            <link port="state.incomingPort" relation="relation4"/>
            <link port="state.outgoingPort" relation="relation"/>
            <link port="state.outgoingPort" relation="relation3"/>
            <link port="init.outgoingPort" relation="relation4"/>
        </entity>
        <entity name="state" class="ptolemy.domains.modal.modal.Refinement">
            <property name="_windowProperties" class="ptolemy.actor.gui.WindowPropertiesAttribute" value="{bounds={595, 253, 815, 517}, maximized=false}">
            </property>
            <property name="_vergilSize" class="ptolemy.actor.gui.SizeAttribute" value="[600, 400]">
            </property>
            <property name="_vergilZoomFactor" class="ptolemy.data.expr.ExpertParameter" value="1.0">
            </property>
            <property name="_vergilCenter" class="ptolemy.data.expr.ExpertParameter" value="{300.0, 200.0}">
            </property>
            <property name="theta_dot_initial" class="ptolemy.data.expr.Parameter" value="1.824378848989386E-5">
                <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
                </property>
                <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
                    <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
                    </property>
                </property>
                <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
                    <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
                </property>
                <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
                </property>
                <property name="_location" class="ptolemy.kernel.util.Location" value="{30.0, 135.0}">
                </property>
            </property>
            <property name="theta_initial" class="ptolemy.data.expr.Parameter" value="0.0">
                <property name="_hideName" class="ptolemy.kernel.util.SingletonAttribute">
                </property>
                <property name="_icon" class="ptolemy.vergil.icon.ValueIcon">
                    <property name="_color" class="ptolemy.actor.gui.ColorAttribute" value="{0.0, 0.0, 1.0, 1.0}">
                    </property>
                </property>
                <property name="_smallIconDescription" class="ptolemy.kernel.util.SingletonConfigurableAttribute">
                    <configure>
      <svg>
        <text x="20" style="font-size:14; font-family:SansSerif; fill:blue" y="20">-P-</text>
      </svg>
    </configure>
                </property>
                <property name="_editorFactory" class="ptolemy.vergil.toolbox.VisibleParameterEditorFactory">
                </property>
                <property name="_location" class="ptolemy.kernel.util.Location" value="{30.0, 110.0}">
                </property>
            </property>
            <property name="Continuous Director" class="ptolemy.domains.continuous.kernel.ContinuousDirector">
                <property name="stopTime" class="ptolemy.data.expr.Parameter" value="Infinity">
                </property>
                <property name="_location" class="ptolemy.kernel.util.Location" value="{110.0, 60.0}">
                </property>
            </property>
            <port name="x_left" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="input"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[482.9375, 201.66666666666666]">
                </property>
            </port>
            <port name="theta_left_dot" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="input"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[460.0, 255.0]">
                </property>
            </port>
            <port name="x_right" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="input"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[478.9375, 308.33333333333337]">
                </property>
            </port>
            <port name="theta_right_dot" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="input"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[456.0, 361.6666666666667]">
                </property>
            </port>
            <port name="x" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="output"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[295.0, 210.0]">
                </property>
            </port>
            <port name="theta_dot" class="ptolemy.domains.modal.modal.RefinementPort">
                <property name="output"/>
                <property name="_location" class="ptolemy.kernel.util.Location" value="[295.0, 250.0]">
                </property>
            </port>
            <entity name="BallDynamics" class="BallClass">
                <property name="_location" class="ptolemy.kernel.util.Location" value="[150.0, 230.0]">
                </property>
                <property name="initialTheta" class="ptolemy.actor.parameters.PortParameter" value="theta_initial">
                </property>
                <property name="initialTheta_dot" class="ptolemy.actor.parameters.PortParameter" value="theta_dot_initial">
                </property>
                <property name="x_offset" class="ptolemy.data.expr.Parameter" value="x_offset">
                </property>
                <property name="Image" class="ptolemy.vergil.kernel.attributes.ImageAttribute">
                    <property name="_location" class="ptolemy.kernel.util.Location" value="[520.0, 310.0]">
                    </property>
                </property>
                <port name="initialTheta" class="ptolemy.actor.parameters.ParameterPort">
                    <property name="input"/>
                    <property name="_location" class="ptolemy.kernel.util.Location" value="{225.0, 30.0}">
                    </property>
                </port>
                <port name="initialTheta_dot" class="ptolemy.actor.parameters.ParameterPort">
                    <property name="input"/>
                    <property name="_location" class="ptolemy.kernel.util.Location" value="{225.0, 60.0}">
                    </property>
                </port>
            </entity>
            <relation name="relation" class="ptolemy.actor.TypedIORelation">
            </relation>
            <relation name="relation2" class="ptolemy.actor.TypedIORelation">
            </relation>
            <link port="x" relation="relation"/>
            <link port="theta_dot" relation="relation2"/>
            <link port="BallDynamics.x" relation="relation"/>
            <link port="BallDynamics.theta_dot" relation="relation2"/>
        </entity>
        <relation name="x_leftRelation" class="ptolemy.actor.TypedIORelation">
        </relation>
        <relation name="theta_left_dotRelation" class="ptolemy.actor.TypedIORelation">
        </relation>
        <relation name="x_rightRelation" class="ptolemy.actor.TypedIORelation">
        </relation>
        <relation name="theta_right_dotRelation" class="ptolemy.actor.TypedIORelation">
        </relation>
        <relation name="xRelation" class="ptolemy.actor.TypedIORelation">
        </relation>
        <relation name="theta_dotRelation" class="ptolemy.actor.TypedIORelation">
        </relation>
        <link port="x_left" relation="x_leftRelation"/>
        <link port="theta_left_dot" relation="theta_left_dotRelation"/>
        <link port="x_right" relation="x_rightRelation"/>
        <link port="theta_right_dot" relation="theta_right_dotRelation"/>
        <link port="x" relation="xRelation"/>
        <link port="theta_dot" relation="theta_dotRelation"/>
        <link port="_Controller.x_left" relation="x_leftRelation"/>
        <link port="_Controller.theta_left_dot" relation="theta_left_dotRelation"/>
        <link port="_Controller.x_right" relation="x_rightRelation"/>
        <link port="_Controller.theta_right_dot" relation="theta_right_dotRelation"/>
        <link port="_Controller.x" relation="xRelation"/>
        <link port="_Controller.theta_dot" relation="theta_dotRelation"/>
        <link port="state.x_left" relation="x_leftRelation"/>
        <link port="state.theta_left_dot" relation="theta_left_dotRelation"/>
        <link port="state.x_right" relation="x_rightRelation"/>
        <link port="state.theta_right_dot" relation="theta_right_dotRelation"/>
        <link port="state.x" relation="xRelation"/>
        <link port="state.theta_dot" relation="theta_dotRelation"/>
    </entity>
    <entity name="Angular Velocities" class="ptolemy.actor.lib.gui.TimedPlotter">
        <property name="legend" class="ptolemy.kernel.util.StringAttribute" value="v_1, v_2, v_3">
        </property>
        <property name="_windowProperties" class="ptolemy.actor.gui.WindowPropertiesAttribute" value="{bounds={0, 382, 508, 355}, maximized=false}">
        </property>
        <property name="_plotSize" class="ptolemy.actor.gui.SizeAttribute" value="[500, 300]">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[355.0, 445.0]">
        </property>
        <configure>
<?plotml <!DOCTYPE plot PUBLIC "-//UC Berkeley//DTD PlotML 1//EN"
"http://ptolemy.eecs.berkeley.edu/xml/dtd/PlotML_1.dtd">
<plot>
<title>Angular Velocities</title>
<xLabel></xLabel>
<yLabel></yLabel>
<xRange min="0.0" max="30.0"/>
<yRange min="-0.431589192379537" max="0.43175442476197523"/>
</plot>?>
        </configure>
    </entity>
    <entity name="Displacements" class="ptolemy.actor.lib.gui.TimedPlotter">
        <property name="legend" class="ptolemy.kernel.util.StringAttribute" value="x_1, x_2, x_3">
        </property>
        <property name="_windowProperties" class="ptolemy.actor.gui.WindowPropertiesAttribute" value="{bounds={0, 37, 508, 355}, maximized=false}">
        </property>
        <property name="_plotSize" class="ptolemy.actor.gui.SizeAttribute" value="[500, 300]">
        </property>
        <property name="_location" class="ptolemy.kernel.util.Location" value="[380.0, 175.0]">
        </property>
        <configure>
<?plotml <!DOCTYPE plot PUBLIC "-//UC Berkeley//DTD PlotML 1//EN"
"http://ptolemy.eecs.berkeley.edu/xml/dtd/PlotML_1.dtd">
<plot>
<title>Displacements</title>
<xLabel></xLabel>
<yLabel></yLabel>
<xRange min="0.0" max="30.0"/>
<yRange min="-3.0614674589207183" max="7.05727876772454"/>
</plot>?>
        </configure>
    </entity>
    <relation name="relation5" class="ptolemy.actor.TypedIORelation">
        <vertex name="vertex1" value="[295.0, 240.0]">
        </vertex>
    </relation>
    <relation name="relation6" class="ptolemy.actor.TypedIORelation">
        <vertex name="vertex1" value="[295.0, 375.0]">
        </vertex>
    </relation>
    <relation name="relation7" class="ptolemy.actor.TypedIORelation">
        <vertex name="vertex1" value="[220.0, 295.0]">
        </vertex>
    </relation>
    <relation name="relation" class="ptolemy.actor.TypedIORelation">
        <vertex name="vertex1" value="[220.0, 315.0]">
        </vertex>
    </relation>
    <relation name="relation2" class="ptolemy.actor.TypedIORelation">
        <vertex name="vertex1" value="[365.0, 295.0]">
        </vertex>
    </relation>
    <relation name="relation8" class="ptolemy.actor.TypedIORelation">
        <vertex name="vertex1" value="[365.0, 315.0]">
        </vertex>
    </relation>
    <link port="ball 1.x_right" relation="relation5"/>
    <link port="ball 1.theta_right_dot" relation="relation6"/>
    <link port="ball 1.x" relation="relation7"/>
    <link port="ball 1.theta_dot" relation="relation"/>
    <link port="ball 3.x_left" relation="relation5"/>
    <link port="ball 3.theta_left_dot" relation="relation6"/>
    <link port="ball 3.x" relation="relation2"/>
    <link port="ball 3.theta_dot" relation="relation8"/>
    <link port="ball 2.x_left" relation="relation7"/>
    <link port="ball 2.theta_left_dot" relation="relation"/>
    <link port="ball 2.x_right" relation="relation2"/>
    <link port="ball 2.theta_right_dot" relation="relation8"/>
    <link port="ball 2.x" relation="relation5"/>
    <link port="ball 2.theta_dot" relation="relation6"/>
    <link port="Angular Velocities.input" relation="relation"/>
    <link port="Angular Velocities.input" relation="relation6"/>
    <link port="Angular Velocities.input" relation="relation8"/>
    <link port="Displacements.input" relation="relation7"/>
    <link port="Displacements.input" relation="relation5"/>
    <link port="Displacements.input" relation="relation2"/>
</entity>
