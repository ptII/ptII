<!-- $Id$ -->
<html>
  <head>
    <META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=iso-8859-1">
    <link href="../../../../../doc/default.css" rel="stylesheet" type="text/css">
    <title>nc2moml</title>
  </head>
  <body>
    <h1>nc2moml</h1> 

    <p> <a href="http://www.tinyos.net#in_browser" target="_top">TinyOS</a> is an
    event-driven operating system designed for sensor network nodes
    that have very limited resources (e.g., 8K bytes of program
    memory, 512 bytes of RAM).  TinyOS, is used, for example, on the
    Berkeley MICA motes, which are small wireless sensor nodes.  <a
    href="httP://nescc.sourceforge.net#in_browser" target="_top">nesC</a> is an
    extension to the C programming language designed to embody the
    structuring concepts and execution model of TinyOS.

    <p>nc2moml is used to convert nesC files (.nc configuration or
    module files with at least one interface) into <a
    href="http://ptolemy.eecs.berkeley.edu/publications/papers/00/moml#in_browser"
    target="_top">MoML</a> (.moml) files.  This will create the Viptos
    (Ptolemy II) libraries of components that are used to assemble
    models.  TinyOS provides a rich library of nesC components. If you
    install TinyOS 1.x in
    <code>$PTII/vendors/ptinyos/tinyos-1.x</code> , then the Viptos
    (Ptolemy II) configure script will find it and automatically make
    the TinyOS libraries available.

    <h2>Installation notes</h2>

    These nc2moml installation instructions assume that you already
    have the tools required for Viptos installed.  This includes the
    AVR tools, make 3.80 or later, TinyOS 1.x, nesC 1.2.2 or later,
    and if you are running on Windows, Cygwin.  We also assume that
    you have set up the necessary environment variables. If not,
    please see the <a href="../../doc/installation.htm"
    target="main">Ptolemy II PtinyOS Domain Installation Notes</a>.


    <h2>How to install nc2moml</h2>
    
    <ol>
      <li><a name="unzip">Run the script</a> that will unzip the file
      that contains additional compiler flags.  It will place "opts"
      files into various directories in your tinyos-1.x tree.  The
      script assumes that you have placed your tinyos-1.x tree as
      indicated in the instructions in the <a
      href="../../doc/installation.htm" target="main">Ptolemy II
      PtinyOS Domain Installation Notes</a>.
        <pre>
cd $PTII/ptolemy/domains/ptinyos/util
./unzip-opts.sh
        </pre>

        <p>
          If the executable permissions are not set correctly, run:
        <pre>
chmod a+x unzip-opts.sh
        </pre>
        then try the step above again.

        <p> If you placed your tinyos-1.x tree in a different
        location, you can find the <code>opts.tar.gz</code> file in
        <code>$TOSROOT/contrib/ptII</code>.
      </li>

      <li>Make sure that the tools in <CODE>$PTII/bin</CODE> have been built:
        <pre>
cd $PTII/bin
make
        </pre>

      <li> Run the script to generate the .moml files from the .nc files.
        <pre>
cd $PTII/ptolemy/domains/ptinyos/util/nc2moml
./nc2moml
        </pre>

          If the executable permissions are not set correctly, run:
        <pre>
chmod a+x nc2moml*
        </pre>
        then try the step above again.

	The <CODE>nc2moml</CODE> command will take 10-30 minutes to complete.
      </li>

      <li> See if it worked:
        <ol> 
          <li> You should see some valid MoML code in:
            <pre>$PTII/vendors/ptinyos/moml</pre>
            <br>
            The directory structure should reflect that of the TinyOS
            directory structure.

          <li> 
            <ol>
              <li>Try running Viptos:
                <pre>$PTII/bin/vergil -viptos</pre>

              <li>Create a new PtinyOS Graph Editor from the File |
                New menu.

              <li>Click in the left hand pane under Actors to see the
                newly generated directory structure.
            </ol>
        </ol>
      <li> If the last step above did not work, then you probably did
      not install the required tools correctly, or you have version
      conflicts with pre-existing tools (e.g., gcc) on your system.
      Try <a href="../../doc/installation.htm">reinstalling the required
      tools</a> from the RPM's or compiling them from scratch using
      your pre-existing toolset.
    </ol>
</body>
</html>
